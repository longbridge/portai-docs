# Agent 节点

## 是什么

Agent 节点是一个**具备自主决策能力的智能执行节点**。
它不仅能调用大模型生成内容，还可以根据当前任务目标，**自动选择是否使用工具、如何使用工具，以及是否需要多步推理**。

如果说：

* 大模型节点 =「一次性思考」
* 工具节点 =「执行具体动作」

那么：

> **Agent 节点 = 会规划、会判断、会行动的智能体**

## 你可以用它做什么

#### 1. 执行复杂、多步骤任务

Agent 节点适合处理**无法用单一步骤完成的任务**，例如：

* 先分析问题
* 再决定是否调用工具
* 根据工具结果继续思考
* 最终产出结果

整个过程由 Agent 自动完成。

---

#### 2. 自动决定是否调用工具

你不需要显式写“如果调用工具 A，就怎么做”。

Agent 会：

* 理解当前任务目标
* 判断是否需要工具支持
* 自动选择合适的工具
* 使用工具返回结果继续执行

---

#### 3. 在不确定场景下自主决策

Agent 特别适合：

* 用户输入不稳定
* 任务路径不固定
* 结果依赖中间判断

它可以在执行过程中动态调整策略，而不是严格按预设路径执行。

## Agent 的工作方式（理解即可）

Agent 节点在运行时会：

1. 理解你设定的目标和规则
2. 基于当前上下文进行思考
3. 决定下一步行动（继续思考 / 调用工具 / 输出结果）
4. 重复上述过程，直到任务完成

你只需要关注**目标和边界**，不需要控制每一步。

## 你需要配置什么

#### 1. 任务目标（最重要）

清晰告诉 Agent：

* 它要完成什么事情
* 成功的标准是什么

例如：

> “帮助用户找到最合适的解决方案，并给出清晰解释。”

---

#### 2. 可用工具

你需要指定：

* Agent 可以使用哪些工具
* 每个工具能做什么

Agent **只能使用你授权的工具**，不会超出范围。

---

#### 3. 行为约束（可选但强烈建议）

你可以限制 Agent：

* 是否必须返回结构化结果
* 是否可以多次调用工具
* 是否需要在失败时给出说明

这些约束可以显著提升稳定性。

## 输出结果

* Agent 节点会输出：

  * 最终执行结果
  * 或整理后的回答内容
* 输出可以直接连接：

  * Answer 节点（ChatFlow）
  * End 节点（Workflow）

## 使用规则

* Agent 节点通常作为流程中的**核心执行节点**
* 一个流程中可以存在多个 Agent 节点，但不建议过多
* Agent 节点可以替代：

  * 多个大模型节点
  * 多个条件 + 工具组合

## 使用建议（非常重要）

* **任务越复杂，目标越要写清楚**
* 不要让 Agent 同时承担过多职责
* 关键业务流程中，建议：

  * 限制工具数量
  * 限制最大执行步数
* 对可预测任务，优先使用普通节点，Agent 留给“复杂问题”

## 典型场景

* 智能助手（需要推理 + 工具）
* 自动问题解决流程
* 多步信息查询与整理
* 不确定路径的复杂业务处理

## 什么时候不该用 Agent？

* 任务非常简单、确定
* 流程路径固定
* 对执行结果稳定性要求极高

这类场景更适合：

* 大模型节点 + 工具节点
* 条件判断节点的显式控制流程

## Agent 节点小结

> **Agent 节点不是“更强的大模型节点”，
> 而是“更自由、但也更需要约束的智能执行单元”。**

---
下面是一份 **面向使用者的对比说明**，专门解决一个核心问题：
**什么时候该用 Agent 节点，什么时候只用 LLM 节点**

语气是**使用指南 + 决策参考**，不是 PRD，可直接放在文档中。


## 什么时候选用 Agent 节点，什么时候选用 LLM 节点？

Agent 节点和 LLM 节点都依赖大模型能力，但它们适合的场景**完全不同**。
选择合适的节点，可以显著提升流程的稳定性、可控性和执行效率。

## 一句话区别

* **LLM 节点**：
  *"我已经知道要模型做什么，只需要它生成或分析一次结果。"*

* **Agent 节点**：
  *"我只知道目标，但不知道中间要走哪几步，需要它自己决定。"*

## 能力对比一览

| 对比维度      | LLM 节点 | Agent 节点 |
| --------- | ------ | -------- |
| 执行方式      | 单次调用   | 多步自主执行   |
| 是否会自主决策   | 不会   | 会      |
| 是否可自动调用工具 | 不能   | 可以     |
| 是否规划执行路径  | 否    | 是      |
| 执行过程是否可预测 | 高    | 相对较低  |
| 配置复杂度     | 低      | 高        |
| 适合流程类型    | 确定型流程  | 不确定型流程   |

## 什么时候选择 LLM 节点？

当你的任务满足以下特征时，**优先选择 LLM 节点**：

#### 适合场景

* 任务步骤清晰、路径固定
* 只需要模型执行一次推理或生成
* 不需要模型决定是否调用工具
* 对输出稳定性要求较高

#### 常见用途

* 问答回复生成
* 文本总结、改写
* 分类、提取信息
* 生成固定格式的内容

#### 示例

> “根据用户输入，总结三条要点并返回。”

这种场景不需要自主规划，LLM 节点即可胜任。

## 什么时候选择 Agent 节点？

当你的任务具有以下特征时，**应选择 Agent 节点**：

#### 适合场景

* 任务步骤不固定
* 是否调用工具需要临时判断
* 需要多轮思考和尝试
* 执行路径依赖中间结果

#### 常见用途

* 复杂问题解决
* 智能助手
* 多步信息查询与整合
* 需要“边想边做”的任务

#### 示例

> “根据用户问题，判断是否需要查询数据，必要时调用工具，再给出最终结论。”

这种情况下，提前写死流程反而困难，Agent 更合适。

## 选择建议（非常重要）

#### 推荐优先级

1. **能用 LLM 节点解决的，不要用 Agent**
2. **只有在流程不可预知时，才引入 Agent**

原因是：

* LLM 更稳定
* Agent 更灵活，但也更不可控

## 常见误区

**误区一：Agent 比 LLM 更强，应该多用**
实际上 Agent 是"更自由"，不是"更简单"。

**误区二：复杂流程一定要 Agent**
很多复杂流程用多个 LLM + 条件 + 工具反而更可控。

**误区三：Agent 可以替代所有节点**
Agent 更适合"决策型任务"，而不是"规则型任务"。

## 实用速查（直接记这个）

* **要稳定、要可控、要确定结果** → 用 **LLM 节点**
* **要灵活、要自主判断、要多步执行** → 用 **Agent 节点**

---

