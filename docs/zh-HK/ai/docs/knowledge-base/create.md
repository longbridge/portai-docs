# 建立知識庫

本文說明建立與設定知識庫的步驟及主要選項。

## 定義知識庫與檢索方式

路徑：**我的知識庫** → **建立新知識庫**。

在此步驟需填寫：

- **名稱**、**描述**：用於區分與說明該知識庫。
- **檢索設定**：決定在收到用戶查詢後，系統如何在文件中查找相關內容並擷取片段供 LLM 使用。

目前支援三種檢索策略，見下表及下文說明。

| 策略     | 說明概要 |
|----------|----------|
| 向量檢索 | 將問題向量化，與知識庫文字向量比較，取最相似的若干分段。 |
| 全文檢索 | 對文件建立全文索引，按用戶輸入詞彙匹配並回傳包含該詞的片段。 |
| 混合檢索 | 同時進行全文檢索與向量檢索，再按規則合併、重排結果。 |

### 向量檢索

**含義**：將用戶問題轉為查詢向量，與知識庫中文字向量做相似度比較，取最相近的分段。

**可設定項**：

| 項          | 說明 |
|-------------|------|
| Rerank 模型 | 預設關閉。開啟後對向量檢索結果做重排序，可提升 LLM 所用片段的準確度。 |
| TopK        | 回傳與問題最相似的文字分段數量。系統會結合所選模型的上下文視窗動態調節。預設 3，數值越大回傳片段越多。 |
| Score 閾值  | 相似度最低分數，僅高於該值的分段會被召回。預設關閉；閾值越高，召回越少。 |

### 全文檢索

**含義**：為文件建立全文索引，支援按任意詞查詢，回傳包含這些詞的文字片段。

**可設定項**：

| 項          | 說明 |
|-------------|------|
| Rerank 模型 | 預設關閉。開啟後對全文檢索結果做重排序，提升片段品質。 |
| TopK        | 回傳的文字分段數量。系統會結合模型上下文動態調整。預設 3。 |
| Score 閾值  | 僅召回分數高於該值的分段。預設關閉；閾值越高，召回越少。 |

### 混合檢索

**含義**：同時執行全文檢索與向量檢索，並對兩種結果進行合併與重排，得到最終召回片段。

**可設定項**：

| 項          | 說明 |
|-------------|------|
| 權重設定    | 可調節「語義（向量）」與「關鍵詞（全文）」的權重。語義權重為 1 表示僅用向量檢索，利於跨詞義、跨語言匹配；關鍵詞權重為 1 表示僅用全文檢索，適合已知確切術語、且需控制運算量的場景。也可自訂兩者比例以適配業務。 |
| Rerank 模型 | 預設關閉。開啟後對混合檢索結果做重排序。 |
| TopK        | 最終回傳的文字分段數量。預設 3。 |
| Score 閾值  | 僅召回高於該分數的分段。預設關閉。 |

完成名稱、描述與檢索設定後，可選擇「建立空白知識庫」直接完成建立，或點擊「建立」進入下一步上傳檔案。

## 上傳檔案

- **數量與大小**：單次最多上傳 5 個檔案，單個檔案不超過 10 MB。
- **支援格式**：DOCX、PPTX、HTML、PDF、MD、CSV、XLSX、VTT、JPG、PNG、TXT。
- **來源**：目前僅支援從本地上傳，不支援從網頁或其他管道匯入。

## 文字與分段設定

該步驟對內容做預處理與分段，得到後續檢索所使用的「分段」。分段品質直接影響召回效果與回答準確性。

- **預計分塊長度**：除 TXT 外，其餘格式均可設定每個分段的大致字數，系統將儘量按該長度切分。
- **TXT 額外設定**：
  - **分段識別碼**：遇到該字元（串）時進行分段。預設 `\n\n`，即按段落分塊。
  - **分段重疊長度**：相鄰分段之間的重疊字數。適當重疊有助於保持語義連貫、提升召回效果，建議設為分段長度對應 Token 數的 10%～25%。

## 完成建立

確認上傳與分段設定後，等候系統完成資料處理即可。處理完成後，該知識庫即可在應用中被引用與檢索。
